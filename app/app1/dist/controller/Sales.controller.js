sap.ui.define(["sap/ui/core/mvc/Controller"],function(e){"use strict";return e.extend("app1.controller.Sales",{onInit:function(){console.log("Sales Page Loaded")},onAddSale:function(){var e=sap.ui.core.UIComponent.getRouterFor(this);e.navTo("AddSales")},onGenerateInvoice:async function(){var e=this.getView();var t=this.getOwnerComponent().getModel();var n=e.byId("salesTable").getSelectedItem()?.getBindingContext()?.getProperty("ID");if(!n){MessageToast.show("Please select a sale to generate an invoice.");return}var o=t.bindContext("/generateInvoice(...)");o.setParameter("sale",n);try{await o.execute();var a=await o.getBoundContext().requestObject();console.log("Invoice Data:",a);this.showInvoicePopup(a)}catch(e){console.error("Error generating invoice:",e);MessageToast.show("Failed to generate invoice.")}},showInvoicePopup:function(e){var t=`\n        <h2>Invoice #${e.invoiceNumber}</h2>\n        <p><b>Sale Date:</b> ${e.saleDate}</p>\n        <p><b>Customer:</b> ${e.customerName} (${e.customerEmail})</p>\n        <p><b>Product:</b> ${e.productName}</p>\n        <p><b>Quantity:</b> ${e.quantity}</p>\n        <p><b>Unit Price:</b> $${e.unitPrice}</p>\n        <p><b>Total Price:</b> <b>$${e.totalPrice}</b></p>\n        <p><b>Payment Method:</b> ${e.paymentMethod}</p>\n        <p><b>Status:</b> ${e.status}</p>\n    `;var n=new sap.m.Dialog({title:"Invoice",content:new sap.ui.core.HTML({content:t}),buttons:[new sap.m.Button({text:"Download PDF",press:()=>{this.downloadInvoicePDF(e);n.close()}}),new sap.m.Button({text:"Close",press:function(){n.close()}})]});n.open()},downloadInvoicePDF:function(e){var t=new PDFDocument;var n=t.pipe(blobStream());t.fontSize(20).text(`Invoice #${e.invoiceNumber}`,{align:"center"});t.moveDown();t.fontSize(12).text(`Sale Date: ${e.saleDate}`);t.text(`Customer: ${e.customerName} (${e.customerEmail})`);t.text(`Product: ${e.productName}`);t.text(`Quantity: ${e.quantity}`);t.text(`Unit Price: $${e.unitPrice}`);t.text(`Total Price: $${e.totalPrice}`,{bold:true});t.text(`Payment Method: ${e.paymentMethod}`);t.text(`Status: ${e.status}`);t.end();n.on("finish",function(){var e=n.toBlob("application/pdf");var t=URL.createObjectURL(e);window.open(t)})}})});
//# sourceMappingURL=Sales.controller.js.map